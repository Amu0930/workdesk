<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>All in one å·¥ä½œå°</title>
  <meta name="description" content="All in one å·¥ä½œå°ï¼ˆæµ·å¤–äº‹ä¸šéƒ¨å†…éƒ¨ä½¿ç”¨ï¼‰" />

  <!-- âœ… Faviconï¼ˆğŸš€ï¼‰ -->
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">

  <style>
    :root{
      --bg0:#06070b;
      --bg1:#0b1020;
      --glass: rgba(255,255,255,.06);
      --glass2: rgba(255,255,255,.08);
      --stroke: rgba(255,255,255,.14);
      --stroke2: rgba(255,255,255,.10);
      --txt: rgba(255,255,255,.92);
      --muted: rgba(255,255,255,.68);
      --muted2: rgba(255,255,255,.55);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
      --shadow2: 0 8px 20px rgba(0,0,0,.35);
      --radius: 18px;
      --radius2: 14px;
      --navW: 190px;
      --gap: 16px;
      --contentMax: 1280px;
      --accentA: rgba(124,92,255,.75);
      --accentB: rgba(20,190,255,.55);
      --ok: rgba(94, 234, 212, .9);
      --warn: rgba(251, 191, 36, .9);
      --bad: rgba(248, 113, 113, .92);
      --font: -apple-system, BlinkMacSystemFont, "SF Pro Display", "SF Pro Text", "PingFang SC",
              "Hiragino Sans GB", "Microsoft YaHei", "Noto Sans CJK SC", Segoe UI, Roboto, Helvetica, Arial, sans-serif;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:var(--font);
      color:var(--txt);
      background:
        radial-gradient(1200px 600px at 10% 20%, rgba(20,190,255,.22), transparent 55%),
        radial-gradient(900px 600px at 80% 10%, rgba(124,92,255,.22), transparent 55%),
        radial-gradient(1100px 700px at 70% 70%, rgba(255,255,255,.05), transparent 55%),
        linear-gradient(180deg, var(--bg0), var(--bg1));
      overflow-x:hidden;
    }

    /* Layout */
    .shell{
      display:flex;
      gap: var(--gap);
      padding: 18px 18px 26px;
      align-items:flex-start;
    }
    .nav{
      position:sticky;
      top:18px;
      width: var(--navW);
      flex: 0 0 var(--navW);
      border-radius: 20px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid var(--stroke2);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(14px);
      padding: 10px;
    }
    .nav .brand{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 10px 10px 6px;
      border-radius: 14px;
      user-select:none;
    }
    .brand .logo{
      width:34px;height:34px;border-radius:12px;
      display:grid;place-items:center;
      background: linear-gradient(135deg, rgba(124,92,255,.35), rgba(20,190,255,.26));
      border:1px solid rgba(255,255,255,.12);
    }
    .brand .logo span{font-size:18px}
    .brand .name{
      font-weight: 780;
      letter-spacing:.2px;
      font-size: 14px;
      line-height:1.15;
    }
    .nav ul{list-style:none;margin:6px 0 0;padding:0;display:flex;flex-direction:column;gap:8px}
    .nav a{
      display:flex;
      align-items:center;
      gap:10px;
      padding: 11px 12px;
      border-radius: 14px;
      color: var(--txt);
      text-decoration:none;
      background: rgba(255,255,255,.04);
      border:1px solid rgba(255,255,255,.08);
      transition: .18s ease;
      cursor:pointer;
      user-select:none;
    }
    .nav a:hover{transform: translateY(-1px); background: rgba(255,255,255,.06)}
    .nav a.active{
      background: linear-gradient(135deg, rgba(124,92,255,.18), rgba(20,190,255,.12));
      border-color: rgba(124,92,255,.35);
      box-shadow: 0 0 0 2px rgba(124,92,255,.12) inset;
    }
    .nav .icon{
      width:22px;height:22px;border-radius:9px;
      display:grid;place-items:center;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.10);
      flex: 0 0 22px;
      font-size: 12px;
    }
    .nav .label{
      font-weight: 650;
      font-size: 13px;
    }

    .main{
      flex: 1 1 auto;
      min-width: 0;
      display:flex;
      justify-content:center;
    }
    .wrap{
      width: 100%;
      max-width: calc(var(--contentMax) + 40px);
    }

    /* Header */
    .hero{
      border-radius: 22px;
      background: linear-gradient(135deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid var(--stroke);
      box-shadow: var(--shadow);
      backdrop-filter: blur(18px);
      padding: 22px 24px 18px;
      margin-bottom: 14px;
      overflow:hidden;
      position:relative;
    }
    .hero:before{
      content:"";
      position:absolute; inset:-2px;
      background:
        radial-gradient(500px 220px at 18% 30%, rgba(20,190,255,.18), transparent 60%),
        radial-gradient(520px 260px at 80% 20%, rgba(124,92,255,.22), transparent 60%);
      filter: blur(8px);
      pointer-events:none;
    }
    .hero > *{position:relative}
    .titleRow{
      display:flex; align-items:flex-end; justify-content:space-between;
      gap: 14px;
      flex-wrap:wrap;
    }
    .h1{
      display:flex; align-items:center; gap:10px;
      font-size: 40px;
      font-weight: 840;
      letter-spacing: .2px;
      margin:0;
    }
    .sub{
      margin: 6px 0 0;
      color: var(--muted);
      font-size: 14px;
      font-weight: 560;
    }

    /* è½»é‡çš„ç™»å½•çŠ¶æ€åŒºï¼ˆæ”¾åœ¨ hero å³ä¾§ï¼Œä¸æ”¹å¸ƒå±€ï¼‰ */
    .authMini{
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:flex-end;
      min-width: 180px;
    }
    .authMini .line{
      display:flex;
      gap:8px;
      align-items:center;
      justify-content:flex-end;
      flex-wrap:wrap;
    }
    .authMini .state{
      color: var(--muted);
      font-weight: 850;
      font-size: 12px;
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,255,255,.12);
      padding: 6px 10px;
      border-radius: 999px;
      max-width: 260px;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .authMini .btnMini{
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--txt);
      font-weight: 900;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
      transition:.18s ease;
    }
    .authMini .btnMini:hover{background: rgba(255,255,255,.07); transform: translateY(-1px);}

    .clocks{
      display:grid;
      grid-template-columns: repeat(4, minmax(160px, 1fr));
      gap: 10px;
      margin-top: 14px;
    }
    @media (max-width: 1080px){
      .clocks{grid-template-columns: repeat(2, minmax(160px, 1fr));}
    }
    .chip{
      display:flex; align-items:center; gap:10px;
      padding: 10px 12px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: 0 10px 25px rgba(0,0,0,.18) inset;
      min-width:0;
    }
    .chip .flag{width:18px; text-align:center}
    .chip .name{color:var(--muted); font-weight:700; font-size:13px}
    .chip .time{
      margin-left:auto;
      font-variant-numeric: tabular-nums;
      font-weight: 850;
      letter-spacing:.6px;
      font-size: 14px;
      white-space:nowrap;
    }

    /* Section titles */
    .secTitle{
      display:flex; align-items:center; gap:10px;
      margin: 18px 0 10px;
      font-size: 18px;
      font-weight: 820;
      letter-spacing: .2px;
    }
    .secTitle .emoji{opacity:.95}

    /* Cards grid: responsive columns (fix â€œæŒ¤å‡ºå»â€é—®é¢˜) */
    .grid{
      display:grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      align-items:stretch;
    }

    .card{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(16px);
      overflow:hidden;
      position:relative;
      min-width:0;
    }
    .cardHeader{
      display:flex; align-items:center; gap:10px;
      padding: 14px 14px 10px;
      font-weight: 820;
      letter-spacing:.2px;
    }
    .cardHeader .ico{
      width:22px;height:22px;border-radius:9px;
      display:grid;place-items:center;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
      font-size: 12px;
      flex:0 0 22px;
    }
    .cardBody{padding: 0 12px 12px;}
    .links{
      display:flex; flex-direction:column; gap: 8px;
    }
    .link{
      display:flex; align-items:center; gap:10px;
      padding: 10px 12px;
      border-radius: 14px;
      text-decoration:none;
      color: var(--txt);
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.08);
      transition: .18s ease;
      min-width:0;
    }
    .link:hover{background: rgba(255,255,255,.06); transform: translateY(-1px);}
    .link .txt{font-weight: 650; font-size: 14px; min-width:0;}
    .link .arr{
      margin-left:auto;
      opacity:.8;
      font-size: 14px;
      flex: 0 0 auto;
    }

    /* TikTok Portal */
    .portalGrid{
      display:grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      align-items:stretch;
    }
    .portalCol{
      padding: 12px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(16px);
      min-width:0;
    }
    .portalTop{
      display:flex; align-items:center; gap:10px;
      padding: 6px 4px 10px;
      font-weight: 850;
      letter-spacing:.2px;
    }
    .portalTop .flag{width:22px;text-align:center}
    .portalTop .region{font-size:15px}
    .portalGroupTitle{
      color: var(--muted);
      font-weight: 800;
      font-size: 12px;
      margin: 6px 4px 10px;
    }
    .acctList{display:flex; flex-direction:column; gap: 8px}
    .acctRow{
      display:flex; align-items:center; gap:10px;
      padding: 10px 10px;
      border-radius: 14px;
      background: rgba(255,255,255,.035);
      border: 1px solid rgba(255,255,255,.08);
      min-width:0;
    }
    .badge{
      flex:0 0 auto;
      font-size: 12px;
      font-weight: 850;
      color: rgba(255,255,255,.92);
      background: rgba(255,255,255,.06);
      border: 1px solid rgba(255,255,255,.10);
      padding: 5px 8px;
      border-radius: 999px;
    }
    .handle{
      font-weight: 850;
      font-size: 14px;
      letter-spacing:.2px;
      white-space: nowrap; /* ä¸æ¢è¡Œ */
      overflow: visible;   /* ä¸æˆªæ–­ */
      flex: 1 1 auto;
      min-width: 0;
    }
    .go{
      margin-left:auto;
      flex:0 0 auto;
      width:34px;height:34px;border-radius: 12px;
      display:grid;place-items:center;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.12);
      cursor:pointer;
      transition:.18s ease;
      user-select:none;
    }
    .go:hover{transform: translateY(-1px); background: rgba(255,255,255,.07)}
    .go span{opacity:.85; font-size:14px}

    /* TikTok portal helper line */
    .portalHint{
      margin: 2px 4px 10px;
      color: var(--muted2);
      font-size: 12px;
      font-weight: 750;
      line-height: 1.4;
    }
    .portalToolbar{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-end;
      margin: 0 0 10px;
      flex-wrap:wrap;
    }

    /* VPN + Apple row */
    .row2{
      display:grid;
      gap: 12px;
      grid-template-columns: 1fr 1fr;
      align-items:stretch;
    }
    @media (max-width: 980px){
      .row2{grid-template-columns: 1fr;}
    }

    .qrGrid{
      display:grid;
      gap: 12px;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      padding: 12px;
    }
    .qrCard{
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid rgba(255,255,255,.12);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(16px);
      padding: 12px;
      min-width:0;
    }
    .qrTop{
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; margin-bottom: 8px;
    }
    .qrTop .name{font-weight: 900}
    .pill{
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,.22);
      border:1px solid rgba(255,255,255,.12);
      color: var(--muted);
      font-weight: 800;
      font-size: 12px;
      font-variant-numeric: tabular-nums;
      white-space: nowrap;
    }
    .qrWrap{
      background: rgba(255,255,255,.96);
      border-radius: 16px;
      padding: 10px;
      display:grid; place-items:center;
      border: 1px solid rgba(0,0,0,.10);
    }
    .qrWrap img{width: 100%; height:auto; max-width: 200px; border-radius: 10px}
    .small{color: var(--muted2); font-size: 12px; margin-top:8px}

    /* Apple IDs */
    .appleBox{
      padding: 12px;
    }
    .appleHint{
      color: var(--muted2);
      font-size: 12px;
      margin-top: 8px;
    }
    .appleList{
      display:flex; flex-direction:column; gap: 10px;
    }
    .appleItem{
      padding: 12px;
      border-radius: var(--radius2);
      background: rgba(255,255,255,.04);
      border: 1px solid rgba(255,255,255,.10);
      min-width:0;
    }
    .appleHead{
      display:flex; align-items:center; gap:10px;
      margin-bottom: 8px;
      font-weight: 900;
    }
    .kv{
      display:grid;
      grid-template-columns: 72px 1fr 70px;
      gap: 10px;
      align-items:center;
      margin-top: 8px;
    }
    .k{color: var(--muted); font-weight: 850; font-size: 12px}
    .v{
      font-weight: 850;
      font-variant-numeric: tabular-nums;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .btn{
      justify-self:end;
      padding: 8px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      border: 1px solid rgba(255,255,255,.12);
      color: var(--txt);
      font-weight: 850;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
      transition:.18s ease;
    }
    .btn:hover{background: rgba(255,255,255,.07); transform: translateY(-1px);}

    /* News */
    .newsCard{padding: 12px;}
    .newsTop{
      display:flex; align-items:center; justify-content:space-between;
      gap: 10px;
      padding: 6px 4px 10px;
    }
    .newsTop .left{display:flex; align-items:center; gap:10px}
    .newsTop .stamp{color: var(--muted); font-weight: 850; font-size: 12px}
    .newsBullets{
      margin: 8px 6px 10px;
      display:flex; flex-direction:column; gap: 8px;
    }
    .bullet{
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.035);
      border: 1px solid rgba(255,255,255,.08);
      color: rgba(255,255,255,.90);
      font-weight: 650;
      line-height: 1.45;
    }
    details.sources{
      margin: 10px 6px 6px;
      border-radius: 14px;
      background: rgba(255,255,255,.03);
      border: 1px solid rgba(255,255,255,.08);
      overflow:hidden;
    }
    details.sources summary{
      list-style:none;
      cursor:pointer;
      padding: 12px 12px;
      font-weight: 900;
      color: var(--txt);
      user-select:none;
      display:flex; align-items:center; gap:10px;
    }
    details.sources summary::-webkit-details-marker{display:none}
    .srcList{padding: 0 12px 12px; display:flex; flex-direction:column; gap: 8px}
    .src{
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(255,255,255,.035);
      border: 1px solid rgba(255,255,255,.08);
      text-decoration:none;
      color: var(--txt);
      display:flex; flex-direction:column; gap: 4px;
    }
    .src .t{font-weight: 800}
    .src .m{color: var(--muted2); font-size: 12px}

    /* Floating Todo */
    .fab{
      position: fixed;
      right: 18px;
      bottom: 18px;
      display:flex;
      align-items:center;
      gap:10px;
      padding: 12px 14px;
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: var(--shadow2);
      backdrop-filter: blur(14px);
      cursor:pointer;
      user-select:none;
      z-index: 50;
    }
    .fab .sq{
      width:34px;height:34px;border-radius: 14px;
      display:grid;place-items:center;
      background: rgba(255,255,255,.06);
      border:1px solid rgba(255,255,255,.12);
    }
    .fab .t{
      display:flex; flex-direction:column;
      line-height:1.05;
    }
    .fab .t .s{font-size:12px;color:var(--muted); font-weight: 800}
    .fab .t .b{font-size:14px;font-weight: 900}
    .modalMask{
      position: fixed; inset:0;
      background: rgba(0,0,0,.42);
      backdrop-filter: blur(6px);
      display:none;
      z-index: 60;
    }
    .modal{
      position: fixed;
      right: 18px;
      bottom: 84px;
      width: 360px;
      max-width: calc(100vw - 36px);
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.07), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.14);
      box-shadow: var(--shadow);
      backdrop-filter: blur(18px);
      display:none;
      z-index: 70;
      overflow:hidden;
    }
    .modalTop{
      display:flex; align-items:center; justify-content:space-between;
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .modalTop .ttl{font-weight: 950; letter-spacing:.2px}
    .modalTop .x{
      width:34px;height:34px;border-radius: 12px;
      display:grid;place-items:center;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.12);
      cursor:pointer;
      user-select:none;
    }
    .modalBody{padding: 12px;}
    .todoRow{
      display:flex; gap: 8px;
    }
    .todoInput{
      flex:1 1 auto;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: var(--txt);
      padding: 10px 12px;
      outline:none;
      font-weight: 750;
    }
    .todoInput::placeholder{color: rgba(255,255,255,.40)}
    .todoAdd{
      flex:0 0 auto;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(255,255,255,.06);
      color: var(--txt);
      padding: 10px 12px;
      font-weight: 900;
      cursor:pointer;
    }
    .todoList{margin-top: 10px; display:flex; flex-direction:column; gap:8px;}
    .todoItem{
      display:flex; align-items:center; gap:10px;
      padding: 10px 10px;
      border-radius: 14px;
      background: rgba(255,255,255,.035);
      border: 1px solid rgba(255,255,255,.08);
      min-width:0;
    }
    .todoItem input{width:16px;height:16px}
    .todoItem .text{
      font-weight: 750;
      color: rgba(255,255,255,.88);
      flex: 1 1 auto;
      min-width:0;
      overflow:hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    .todoItem.done .text{
      text-decoration: line-through;
      color: rgba(255,255,255,.45);
    }
    .todoItem .del{
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.12);
      color: var(--txt);
      font-weight: 900;
      font-size: 12px;
      cursor:pointer;
      user-select:none;
    }
    .todoFooter{
      margin-top: 10px;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      color: var(--muted2);
      font-size: 12px;
      font-weight: 800;
    }
    .todoClear{
      cursor:pointer;
      user-select:none;
      padding: 7px 10px;
      border-radius: 999px;
      background: rgba(255,255,255,.05);
      border:1px solid rgba(255,255,255,.12);
      color: var(--txt);
      font-weight: 900;
      font-size: 12px;
    }

    /* âœ… Auth Modalï¼ˆæ›¿æ¢ prompt é—¨ç¦ï¼Œä¸åŠ¨å…¶å®ƒæ¨¡å—ï¼‰ */
    .authMask{
      position: fixed; inset:0;
      background: rgba(0,0,0,.55);
      backdrop-filter: blur(8px);
      display:none;
      z-index: 200;
    }
    .authModal{
      position: fixed;
      left: 50%;
      top: 50%;
      transform: translate(-50%, -50%);
      width: 420px;
      max-width: calc(100vw - 36px);
      border-radius: 18px;
      background: linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.04));
      border: 1px solid rgba(255,255,255,.16);
      box-shadow: var(--shadow);
      backdrop-filter: blur(18px);
      display:none;
      z-index: 210;
      overflow:hidden;
    }
    .authTop{
      display:flex; align-items:center; justify-content:space-between;
      padding: 12px 12px;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }
    .authTop .ttl{
      font-weight: 950;
      letter-spacing:.2px;
      display:flex; align-items:center; gap:10px;
    }
    .authBody{padding: 12px;}
    .authHint{
      color: var(--muted);
      font-weight: 750;
      font-size: 12px;
      line-height: 1.5;
      margin: 2px 2px 10px;
    }
    .authField{
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-top: 10px;
    }
    .authLabel{
      color: var(--muted2);
      font-weight: 850;
      font-size: 12px;
      margin-left: 2px;
    }
    .authInput{
      width:100%;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.14);
      background: rgba(0,0,0,.20);
      color: var(--txt);
      padding: 10px 12px;
      outline:none;
      font-weight: 750;
    }
    .authInput::placeholder{color: rgba(255,255,255,.40)}
    .authActions{
      display:flex;
      gap:10px;
      align-items:center;
      justify-content:flex-end;
      margin-top: 12px;
      flex-wrap:wrap;
    }
    .authErr{
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 14px;
      background: rgba(248, 113, 113, .12);
      border: 1px solid rgba(248, 113, 113, .25);
      color: rgba(255,255,255,.92);
      font-weight: 800;
      font-size: 12px;
      display:none;
      line-height: 1.45;
      white-space: pre-wrap;
    }

    /* Helpers */
    .spacer{height: 18px;}
    .anchor{scroll-margin-top: 18px;}
  </style>
</head>
<body>
  <div class="shell">
    <!-- Left Nav (compact) -->
    <aside class="nav" aria-label="å¯¼èˆª">
      <div class="brand">
        <div class="logo"><span>ğŸš€</span></div>
        <div class="name">All in one</div>
      </div>
      <ul>
        <li><a class="navLink active" href="#sec-links" data-target="sec-links"><span class="icon">ğŸ“Œ</span><span class="label">å¸¸ç”¨ç½‘ç«™</span></a></li>
        <li><a class="navLink" href="#sec-portal" data-target="sec-portal"><span class="icon">ğŸ“œ</span><span class="label">TikTokè´¦å·ä¼ é€é—¨</span></a></li>
        <li><a class="navLink" href="#sec-vpn" data-target="sec-vpn"><span class="icon">ğŸªœ</span><span class="label">å°ç«ç®­èŠ‚ç‚¹</span></a></li>
        <li><a class="navLink" href="#sec-apple" data-target="sec-apple"><span class="icon">ğŸ</span><span class="label">Apple IDï¼ˆå„åŒºï¼‰</span></a></li>
        <li><a class="navLink" href="#sec-news" data-target="sec-news"><span class="icon">ğŸ’¡</span><span class="label">æœ€æ–°èµ„è®¯</span></a></li>
      </ul>
    </aside>

    <!-- Main -->
    <main class="main">
      <div class="wrap">
        <!-- Header -->
        <section class="hero">
          <div class="titleRow">
            <div>
              <h1 class="h1">ğŸš€ All in one å·¥ä½œå°</h1>
              <div class="sub">ä»…æµ·å¤–äº‹ä¸šéƒ¨å†…éƒ¨ä½¿ç”¨</div>
            </div>

            <!-- âœ… ç™»å½•çŠ¶æ€ï¼ˆæ–°å¢ï¼šä¸æ”¹ä½ ç°æœ‰é£æ ¼/å¸ƒå±€ï¼‰ -->
            <div class="authMini" aria-label="ç™»å½•çŠ¶æ€">
              <div class="line">
                <div class="state" id="authState">æœªç™»å½•</div>
              </div>
              <div class="line">
                <button class="btnMini" id="btnOpenLogin">ç™»å½•</button>
                <button class="btnMini" id="btnLogout" style="display:none;">é€€å‡º</button>
              </div>
            </div>
          </div>

          <div class="clocks" id="clockRow">
            <div class="chip"><span class="flag">ğŸ‡ºğŸ‡¸</span><span class="name">ç¾å›½</span><span class="time" id="tLA">--:--:--</span></div>
            <div class="chip"><span class="flag">ğŸ‡¸ğŸ‡¬</span><span class="name">æ–°åŠ å¡</span><span class="time" id="tSG">--:--:--</span></div>
            <div class="chip"><span class="flag">ğŸ‡»ğŸ‡³</span><span class="name">è¶Šå—</span><span class="time" id="tVN">--:--:--</span></div>
            <div class="chip"><span class="flag">ğŸ‡²ğŸ‡¾</span><span class="name">é©¬æ¥è¥¿äºš</span><span class="time" id="tMY">--:--:--</span></div>
          </div>
        </section>

        <!-- å¸¸ç”¨ç½‘ç«™ -->
        <section id="sec-links" class="anchor">
          <div class="secTitle"><span class="emoji">ğŸ“Œ</span> å¸¸ç”¨ç½‘ç«™</div>
          <div class="grid">
            <div class="card">
              <div class="cardHeader"><span class="ico">ğŸ“±</span> TikTokè¿è¥å…¥å£</div>
              <div class="cardBody">
                <div class="links">
                  <a class="link" href="https://seller.tiktokshopglobalselling.com/account/login" target="_blank" rel="noopener"><span class="txt">è·¨å¢ƒåº—åå°</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://seller-vn.tiktok.com/account/login" target="_blank" rel="noopener"><span class="txt">è¶Šå—æœ¬åœŸåº—åå°</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://business.tiktok.com/zh" target="_blank" rel="noopener"><span class="txt">å•†åŠ¡ä¸­å¿ƒåå°</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://ads.tiktok.com/" target="_blank" rel="noopener"><span class="txt">å¹¿å‘Šæˆ·åå°</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://www.tiktok.com/" target="_blank" rel="noopener"><span class="txt">TikTokï¼ˆå‰å°ï¼‰</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://seller.tiktokglobalshop.com/university/home" target="_blank" rel="noopener"><span class="txt">å–å®¶å¤§å­¦</span><span class="arr">â†—</span></a>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="cardHeader"><span class="ico">ğŸ¤–</span> AIå·¥å…·</div>
              <div class="cardBody">
                <div class="links">
                  <a class="link" href="https://chatgpt.com/" target="_blank" rel="noopener"><span class="txt">ChatGPT</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://gemini.google.com/app" target="_blank" rel="noopener"><span class="txt">Gemini</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://elevenlabs.io/app/sign-in?redirect=/app/speech-synthesis/text-to-speech" target="_blank" rel="noopener"><span class="txt">ElevenLabs</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://labs.google/fx/zh/tools/flow" target="_blank" rel="noopener"><span class="txt">Nano banana / Veo3</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://sora.chatgpt.com/explore" target="_blank" rel="noopener"><span class="txt">Sora2</span><span class="arr">â†—</span></a>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="cardHeader"><span class="ico">ğŸ“Š</span> æ•°æ®åˆ†æ</div>
              <div class="cardBody">
                <div class="links">
                  <a class="link" href="https://www.fastmoss.com/zh" target="_blank" rel="noopener"><span class="txt">FastMoss</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://www.kalodata.com/login" target="_blank" rel="noopener"><span class="txt">Kalodata</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://echotik.live/board" target="_blank" rel="noopener"><span class="txt">EchoTik</span><span class="arr">â†—</span></a>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="cardHeader"><span class="ico">ğŸšš</span> å‘è´§</div>
              <div class="cardBody">
                <div class="links">
                  <a class="link" href="https://oms2.szestp.com/login" target="_blank" rel="noopener"><span class="txt">æ˜“é€Ÿè²</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://wms.nxcang.com/#/login" target="_blank" rel="noopener"><span class="txt">å—æºª</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://www.erp321.com/login.aspx" target="_blank" rel="noopener"><span class="txt">èšæ°´æ½­</span><span class="arr">â†—</span></a>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="cardHeader"><span class="ico">ğŸ§°</span> å…¶ä»–å¸¸ç”¨</div>
              <div class="cardBody">
                <div class="links">
                  <a class="link" href="https://translate.google.com/?hl=zh-cn" target="_blank" rel="noopener"><span class="txt">Googleç¿»è¯‘</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://wise.com/zh-cn/currency-converter/" target="_blank" rel="noopener"><span class="txt">æ±‡ç‡è®¡ç®—</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://sucaiwang.zhishangsoft.com/#/login?redirect=%2Fhome" target="_blank" rel="noopener"><span class="txt">äº‘è§†é¢‘ç®¡å®¶</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://www.henghengmao.net/en" target="_blank" rel="noopener"><span class="txt">è§†é¢‘å»æ°´å°æ‰¹é‡ä¸‹è½½</span><span class="arr">â†—</span></a>
                  <a class="link" href="https://nmqzm.199lab.com/" target="_blank" rel="noopener"><span class="txt">è§†é¢‘å»å­—å¹•</span><span class="arr">â†—</span></a>
                </div>
              </div>
            </div>

          </div>
        </section>

        <!-- TikTokè´¦å·ä¼ é€é—¨ -->
        <section id="sec-portal" class="anchor">
          <div class="secTitle"><span class="emoji">ğŸ“œ</span> TikTokè´¦å·ä¼ é€é—¨</div>

          <!-- âœ… ä¸æ”¹å¸ƒå±€ï¼šåªåŠ ä¸€ä¸ªå°å·¥å…·æ¡ï¼ˆç™»å½•/åˆ·æ–°æç¤ºï¼‰ -->
          <div class="portalToolbar">
            <div class="pill" id="portalPill">æœªç™»å½• Â· è´¦å·åˆ—è¡¨æœªåŠ è½½</div>
            <button class="btn" id="portalRefreshBtn">åˆ·æ–°è´¦å·</button>
          </div>

          <div class="portalGrid">
            <!-- US -->
            <div class="portalCol">
              <div class="portalTop"><span class="flag">ğŸ‡ºğŸ‡¸</span><span class="region">ç¾å›½</span></div>
              <div id="portal-US">
                <div class="portalGroupTitle">è‡ªè¥è´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
                <div class="portalGroupTitle" style="margin-top:12px;">è¾¾äººè´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
              </div>
            </div>

            <!-- SG -->
            <div class="portalCol">
              <div class="portalTop"><span class="flag">ğŸ‡¸ğŸ‡¬</span><span class="region">æ–°åŠ å¡</span></div>
              <div id="portal-SG">
                <div class="portalGroupTitle">è‡ªè¥è´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
                <div class="portalGroupTitle" style="margin-top:12px;">è¾¾äººè´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
              </div>
            </div>

            <!-- VN -->
            <div class="portalCol">
              <div class="portalTop"><span class="flag">ğŸ‡»ğŸ‡³</span><span class="region">è¶Šå—</span></div>
              <div id="portal-VN">
                <div class="portalGroupTitle">è‡ªè¥è´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
                <div class="portalGroupTitle" style="margin-top:12px;">è¾¾äººè´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
              </div>
            </div>

            <!-- MY -->
            <div class="portalCol">
              <div class="portalTop"><span class="flag">ğŸ‡²ğŸ‡¾</span><span class="region">é©¬æ¥è¥¿äºš</span></div>
              <div id="portal-MY">
                <div class="portalGroupTitle">è‡ªè¥è´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
                <div class="portalGroupTitle" style="margin-top:12px;">è¾¾äººè´¦å·</div>
                <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
              </div>
            </div>
          </div>
        </section>

        <!-- å°ç«ç®­ + Apple IDï¼ˆå„å ä¸€æ’æ›´èˆ’æœï¼šè¿™é‡ŒåšæˆåŒä¸€è¡Œä¸¤æ ï¼Œåœ¨çª„å±è‡ªåŠ¨æ¢è¡Œï¼‰ -->
        <section id="sec-vpn" class="anchor">
          <div class="secTitle"><span class="emoji">ğŸªœ</span> å°ç«ç®­èŠ‚ç‚¹</div>

          <div class="row2">
            <!-- VPN -->
            <div class="card">
              <div class="cardHeader"><span class="ico">ğŸªœ</span> å°ç«ç®­èŠ‚ç‚¹</div>
              <div class="qrGrid">
                <div class="qrCard">
                  <div class="qrTop">
                    <div class="name">æ–°åŠ å¡</div>
                    <div class="pill">åˆ°æœŸï¼š2026-02-16 Â· <span id="ddSG">--</span></div>
                  </div>
                  <div class="qrWrap"><img src="æ–°åŠ å¡.png" alt="æ–°åŠ å¡èŠ‚ç‚¹äºŒç»´ç " /></div>
                </div>

                <div class="qrCard">
                  <div class="qrTop">
                    <div class="name">ç¾å›½1</div>
                    <div class="pill">åˆ°æœŸï¼š2026-02-28 Â· <span id="ddUS1">--</span></div>
                  </div>
                  <div class="qrWrap"><img src="ç¾å›½1.png" alt="ç¾å›½1èŠ‚ç‚¹äºŒç»´ç " /></div>
                </div>

                <div class="qrCard">
                  <div class="qrTop">
                    <div class="name">ç¾å›½2</div>
                    <div class="pill">åˆ°æœŸï¼š2026-02-28 Â· <span id="ddUS2">--</span></div>
                  </div>
                  <div class="qrWrap"><img src="ç¾å›½2.png" alt="ç¾å›½2èŠ‚ç‚¹äºŒç»´ç " /></div>
                </div>
              </div>
            </div>

            <!-- Apple -->
            <div class="card" id="sec-apple">
              <div class="cardHeader"><span class="ico">ğŸ</span> Apple IDï¼ˆå„åŒºï¼‰</div>
              <div class="appleBox">
                <div class="appleList">

                  <div class="appleItem">
                    <div class="appleHead">ğŸ‡ºğŸ‡¸ ç¾å›½ï¼ˆå°ç«ç®­ï¼‰</div>
                    <div class="kv">
                      <div class="k">è´¦å·</div>
                      <div class="v" id="apple_us_id">leichisha815772@hotmail.com</div>
                      <div class="btn" data-copy="#apple_us_id">å¤åˆ¶</div>
                    </div>
                    <div class="kv">
                      <div class="k">å¯†ç </div>
                      <div class="v" id="apple_us_pw">Zx668844</div>
                      <div class="btn" data-copy="#apple_us_pw">å¤åˆ¶</div>
                    </div>
                  </div>

                  <div class="appleItem">
                    <div class="appleHead">ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡</div>
                    <div class="kv">
                      <div class="k">è´¦å·</div>
                      <div class="v" id="apple_sg_id">csgdj83297@hotmail.com</div>
                      <div class="btn" data-copy="#apple_sg_id">å¤åˆ¶</div>
                    </div>
                    <div class="kv">
                      <div class="k">å¯†ç </div>
                      <div class="v" id="apple_sg_pw">Zx668844</div>
                      <div class="btn" data-copy="#apple_sg_pw">å¤åˆ¶</div>
                    </div>
                  </div>

                  <div class="appleItem">
                    <div class="appleHead">ğŸ‡»ğŸ‡³ è¶Šå—</div>
                    <div class="kv">
                      <div class="k">è´¦å·</div>
                      <div class="v" id="apple_vn_id">ankil90770@hotmail.com</div>
                      <div class="btn" data-copy="#apple_vn_id">å¤åˆ¶</div>
                    </div>
                    <div class="kv">
                      <div class="k">å¯†ç </div>
                      <div class="v" id="apple_vn_pw">Zx668844</div>
                      <div class="btn" data-copy="#apple_vn_pw">å¤åˆ¶</div>
                    </div>
                  </div>

                  <div class="appleItem">
                    <div class="appleHead">ğŸ‡²ğŸ‡¾ é©¬æ¥è¥¿äºš</div>
                    <div class="kv">
                      <div class="k">è´¦å·</div>
                      <div class="v" id="apple_my_id">turne.kirby21@meantodeal.com</div>
                      <div class="btn" data-copy="#apple_my_id">å¤åˆ¶</div>
                    </div>
                    <div class="kv">
                      <div class="k">å¯†ç </div>
                      <div class="v" id="apple_my_pw">MHtQ2288</div>
                      <div class="btn" data-copy="#apple_my_pw">å¤åˆ¶</div>
                    </div>
                  </div>

                </div>
                <div class="appleHint">æç¤ºï¼šåœ¨ Apple Store é‡Œç™»é™†ï¼Œè¯·å‹¿åœ¨è®¾ç½®é‡Œç™»é™†ã€‚</div>
              </div>
            </div>
          </div>
        </section>

        <!-- æœ€æ–°èµ„è®¯ -->
        <section id="sec-news" class="anchor">
          <div class="secTitle"><span class="emoji">ğŸ’¡</span> æœ€æ–°èµ„è®¯</div>
          <div class="card">
            <div class="cardHeader"><span class="ico">ğŸ’¡</span> ä»Šæ—¥ TikTok è¦ç‚¹ï¼ˆAI æç‚¼ï¼‰</div>
            <div class="newsCard">
              <div class="newsTop">
                <div class="left">
                  <span class="stamp" id="newsStamp">æ­£åœ¨åŠ è½½â€¦</span>
                </div>
                <div>
                  <button class="btn" id="newsRefresh">åˆ·æ–°</button>
                </div>
              </div>

              <div class="newsBullets" id="newsBullets">
                <div class="bullet">æ­£åœ¨åŠ è½½â€¦</div>
              </div>

              <details class="sources" id="newsSourcesWrap">
                <summary>ä¿¡æ¯æ¥æº</summary>
                <div class="srcList" id="newsSources"></div>
              </details>

              <div class="small" id="newsTip"></div>
            </div>
          </div>
        </section>

        <div class="spacer"></div>
      </div>
    </main>
  </div>

  <!-- Floating ToDo -->
  <div class="fab" id="todoFab" title="To do List">
    <div class="sq">ğŸ“</div>
    <div class="t">
      <div class="s">Quick</div>
      <div class="b">To do</div>
    </div>
  </div>

  <div class="modalMask" id="todoMask"></div>
  <div class="modal" id="todoModal" role="dialog" aria-modal="true" aria-label="To do List">
    <div class="modalTop">
      <div class="ttl">âœ… To do List</div>
      <div class="x" id="todoClose" title="å…³é—­">âœ•</div>
    </div>
    <div class="modalBody">
      <div class="todoRow">
        <input class="todoInput" id="todoInput" placeholder="è¾“å…¥å¾…åŠäº‹é¡¹ï¼Œç„¶åç‚¹å‡»åˆ›å»º" />
        <button class="todoAdd" id="todoAddBtn">åˆ›å»º</button>
      </div>

      <div class="todoList" id="todoList"></div>

      <div class="todoFooter">
        <div id="todoCount">0 items</div>
        <div class="todoClear" id="todoClearBtn">æ¸…é™¤å·²å®Œæˆ</div>
      </div>
    </div>
  </div>

  <!-- âœ… Auth Gateï¼ˆæ›¿æ¢ promptï¼‰ -->
  <div class="authMask" id="authMask"></div>
  <div class="authModal" id="authModal" role="dialog" aria-modal="true" aria-label="ç™»å½•">
    <div class="authTop">
      <div class="ttl">ğŸ” ç™»å½•å·¥ä½œå°</div>
      <div class="x" id="authClose" title="å…³é—­">âœ•</div>
    </div>
    <div class="authBody">
      <div class="authHint">ä½¿ç”¨ Supabase è´¦å·ç™»å½•ã€‚ç™»å½•åå°†è‡ªåŠ¨åŠ è½½ã€ŒTikTokè´¦å·ä¼ é€é—¨ã€ã€‚</div>

      <div class="authField">
        <div class="authLabel">é‚®ç®±</div>
        <input class="authInput" id="authEmail" placeholder="ä¾‹å¦‚ï¼šname@company.com" autocomplete="username" />
      </div>

      <div class="authField">
        <div class="authLabel">å¯†ç </div>
        <input class="authInput" id="authPassword" type="password" placeholder="è¯·è¾“å…¥å¯†ç " autocomplete="current-password" />
      </div>

      <div class="authActions">
        <button class="btn" id="authLoginBtn">ç™»å½•</button>
      </div>

      <div class="authErr" id="authErr"></div>
    </div>
  </div>

  <!-- âœ… Supabase JSï¼ˆCDNï¼Œä¸éœ€è¦å®‰è£…ä»»ä½•ä¸œè¥¿ï¼‰ -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <script>
    /********************
     * 0) Config
     ********************/
    // ä½ çš„ Cloudflare Worker åœ°å€ï¼ˆåé¢ä½ éƒ¨ç½²å¥½åï¼ŒæŠŠå®ƒæ›¿æ¢æˆçœŸå® URLï¼‰
    // ä¾‹å¦‚ï¼šhttps://aio-news.yourname.workers.dev/news
    const NEWS_API_URL = ""; // <-- è¿™é‡Œå¿…å¡«

    // âœ… Supabaseï¼ˆåªç”¨äº ç™»å½• + tiktok_accounts è¯»å–ï¼‰
    const SUPABASE_URL = "https://wzdziscgnzinwpuoqnge.supabase.co";
    const SUPABASE_ANON_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6ZHppc2NnbnppbndwdW9xbmdlIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzExNDg4MTcsImV4cCI6MjA4NjcyNDgxN30.L3CYmSpWgUL0ftQ1bIfchsIb7WBmWotiipUTPHHQla8";

    // è´¦å·åˆ†ç±»æ˜¾ç¤ºåï¼ˆå°½é‡å…¼å®¹ä½ å¯èƒ½å¡«çš„å€¼ï¼‰
    function prettyAccountType(v){
      const s = String(v || "").trim().toLowerCase();
      // å¸¸è§ï¼šè‡ªè¥/è¾¾äºº
      if(s === "è‡ªè¥" || s === "self" || s === "owned" || s === "inhouse") return "è‡ªè¥è´¦å·";
      if(s === "è¾¾äºº" || s === "creator" || s === "affiliate" || s === "koc" || s === "kol") return "è¾¾äººè´¦å·";
      // å…œåº•ï¼šåŸæ ·å±•ç¤º
      return v ? String(v) : "è´¦å·";
    }

    // åœ°åŒºè§„èŒƒåŒ–ï¼šUS/SG/VN/MYï¼ˆå…¼å®¹ä½ å¯èƒ½å¡«â€œç¾å›½/æ–°åŠ å¡â€ç­‰ï¼‰
    function normRegion(v){
      const s = String(v || "").trim().toUpperCase();
      if(s === "US" || s === "USA" || s.includes("ç¾") || s.includes("UNITED")) return "US";
      if(s === "SG" || s.includes("æ–°") || s.includes("SING")) return "SG";
      if(s === "VN" || s.includes("è¶Š") || s.includes("VIET")) return "VN";
      if(s === "MY" || s.includes("é©¬") || s.includes("MALAY")) return "MY";
      return s || "US";
    }

    // handle -> ç”Ÿæˆæ‰“å¼€é“¾æ¥
    function handleToUrl(handle){
      const h = String(handle || "").trim();
      if(!h) return "";
      if(/^https?:\/\//i.test(h)) return h;
      const clean = h.startsWith("@") ? h.slice(1) : h;
      return "https://www.tiktok.com/@" + encodeURIComponent(clean);
    }

    /********************
     * 1) Clocks (LA / SG / VN / MY)
     ********************/
    function fmtTime(tz){
      return new Intl.DateTimeFormat('zh-CN', {
        hour: '2-digit', minute: '2-digit', second: '2-digit',
        hour12: false, timeZone: tz
      }).format(new Date());
    }
    function tickClocks(){
      // ç¾å›½ = æ´›æ‰çŸ¶æ—¶é—´
      document.getElementById('tLA').textContent = fmtTime('America/Los_Angeles');
      document.getElementById('tSG').textContent = fmtTime('Asia/Singapore');
      document.getElementById('tVN').textContent = fmtTime('Asia/Ho_Chi_Minh');
      document.getElementById('tMY').textContent = fmtTime('Asia/Kuala_Lumpur');
    }
    tickClocks();
    setInterval(tickClocks, 1000);

    /********************
     * 2) Countdown pills
     ********************/
    function daysLeft(dateStr){
      const end = new Date(dateStr + "T23:59:59");
      const now = new Date();
      const ms = end - now;
      const d = Math.ceil(ms / (1000*60*60*24));
      return Math.max(d, 0);
    }
    function tickCountdown(){
      document.getElementById('ddSG').textContent = `å‰©ä½™ ${daysLeft("2026-02-16")} å¤©`;
      document.getElementById('ddUS1').textContent = `å‰©ä½™ ${daysLeft("2026-02-28")} å¤©`;
      document.getElementById('ddUS2').textContent = `å‰©ä½™ ${daysLeft("2026-02-28")} å¤©`;
    }
    tickCountdown();
    setInterval(tickCountdown, 60*1000);

    /********************
     * 3) Sidebar active highlight (stable)
     ********************/
    const navLinks = Array.from(document.querySelectorAll('.navLink'));
    function setActive(id){
      navLinks.forEach(a => a.classList.toggle('active', a.dataset.target === id));
    }
    // Click smooth scroll
    navLinks.forEach(a=>{
      a.addEventListener('click', (e)=>{
        // allow default anchor
        const id = a.dataset.target;
        const el = document.getElementById(id);
        if(el){
          e.preventDefault();
          el.scrollIntoView({behavior:'smooth', block:'start'});
          history.replaceState(null, '', '#' + id);
          setActive(id);
        }
      });
    });
    // Observer: choose section most visible
    const sectionIds = ["sec-links","sec-portal","sec-vpn","sec-news"];
    const sections = sectionIds.map(id => document.getElementById(id)).filter(Boolean);

    const io = new IntersectionObserver((entries)=>{
      // pick entry with max intersection ratio
      let best = null;
      for(const ent of entries){
        if(!ent.isIntersecting) continue;
        if(!best || ent.intersectionRatio > best.intersectionRatio){
          best = ent;
        }
      }
      if(best && best.target && best.target.id){
        setActive(best.target.id);
      }
    }, {
      root: null,
      threshold: [0.12, 0.2, 0.35, 0.5, 0.65],
      rootMargin: "-20% 0px -55% 0px" // æ›´è´´è¿‘â€œå½“å‰åŒºåŸŸåœ¨ä¸ŠåŠå±â€çš„æ„Ÿè§‰
    });
    sections.forEach(s=>io.observe(s));

    /********************
     * 4) Copy helper (Apple IDs)
     ********************/
    async function copyText(text){
      try{
        await navigator.clipboard.writeText(text);
      }catch(e){
        // fallback
        const ta = document.createElement('textarea');
        ta.value = text;
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
      }
    }
    document.querySelectorAll('[data-copy]').forEach(b=>{
      b.addEventListener('click', async ()=>{
        const sel = b.getAttribute('data-copy');
        const el = document.querySelector(sel);
        if(!el) return;
        await copyText(el.textContent.trim());
        const old = b.textContent;
        b.textContent = "å·²å¤åˆ¶";
        setTimeout(()=> b.textContent = old, 900);
      });
    });

    /********************
     * 5) ToDo (localStorage, per-browser independent)
     ********************/
    const TODO_KEY = "aio_todos_v1";
    const fab = document.getElementById('todoFab');
    const mask = document.getElementById('todoMask');
    const modal = document.getElementById('todoModal');
    const closeBtn = document.getElementById('todoClose');

    const input = document.getElementById('todoInput');
    const addBtn = document.getElementById('todoAddBtn');
    const listEl = document.getElementById('todoList');
    const countEl = document.getElementById('todoCount');
    const clearBtn = document.getElementById('todoClearBtn');

    function loadTodos(){
      try{
        const raw = localStorage.getItem(TODO_KEY);
        if(!raw) return [];
        const arr = JSON.parse(raw);
        return Array.isArray(arr) ? arr : [];
      }catch(e){ return []; }
    }
    function saveTodos(todos){
      localStorage.setItem(TODO_KEY, JSON.stringify(todos));
    }
    function renderTodos(){
      const todos = loadTodos();
      listEl.innerHTML = "";

      if(todos.length === 0){
        const empty = document.createElement('div');
        empty.className = "bullet";
        empty.textContent = "æš‚æ— ";
        listEl.appendChild(empty);
        countEl.textContent = "0 items";
        return;
      }

      let left = 0;
      todos.forEach((t, idx)=>{
        if(!t.done) left++;

        const row = document.createElement('div');
        row.className = "todoItem" + (t.done ? " done" : "");

        const cb = document.createElement('input');
        cb.type = "checkbox";
        cb.checked = !!t.done;
        cb.addEventListener('change', ()=>{
          const next = loadTodos();
          next[idx].done = cb.checked;
          saveTodos(next);
          renderTodos();
        });

        const tx = document.createElement('div');
        tx.className = "text";
        tx.textContent = t.text;

        const del = document.createElement('div');
        del.className = "del";
        del.textContent = "åˆ é™¤";
        del.addEventListener('click', ()=>{
          const next = loadTodos();
          next.splice(idx, 1);
          saveTodos(next);
          renderTodos();
        });

        row.appendChild(cb);
        row.appendChild(tx);
        row.appendChild(del);
        listEl.appendChild(row);
      });

      countEl.textContent = `${left} items`;
    }

    function addTodo(){
      const v = (input.value || "").trim();
      if(!v) return;
      const todos = loadTodos();
      todos.unshift({text: v, done:false, ts: Date.now()});
      saveTodos(todos);
      input.value = "";
      renderTodos();
    }
    addBtn.addEventListener('click', addTodo);
    input.addEventListener('keydown', (e)=>{
      if(e.key === "Enter") addTodo();
    });
    clearBtn.addEventListener('click', ()=>{
      const todos = loadTodos();
      const next = todos.filter(t => !t.done);
      saveTodos(next);
      renderTodos();
    });

    function openTodo(){
      mask.style.display = "block";
      modal.style.display = "block";
      renderTodos();
      setTimeout(()=> input.focus(), 50);
    }
    function closeTodo(){
      mask.style.display = "none";
      modal.style.display = "none";
    }
    fab.addEventListener('click', openTodo);
    mask.addEventListener('click', closeTodo);
    closeBtn.addEventListener('click', closeTodo);

    /********************
     * 6) News (AI summary via Worker)
     ********************/
    const stampEl = document.getElementById('newsStamp');
    const bulletsEl = document.getElementById('newsBullets');
    const sourcesEl = document.getElementById('newsSources');
    const tipEl = document.getElementById('newsTip');
    const refreshBtn = document.getElementById('newsRefresh');

    function setLoading(){
      stampEl.textContent = "æ­£åœ¨åŠ è½½â€¦";
      bulletsEl.innerHTML = `<div class="bullet">æ­£åœ¨åŠ è½½â€¦</div>`;
      sourcesEl.innerHTML = "";
      tipEl.textContent = "";
    }

    function esc(s){
      return String(s||"").replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    async function loadNews(){
      setLoading();

      if(!NEWS_API_URL){
        stampEl.textContent = "æœªé…ç½®èµ„è®¯æ¥å£";
        bulletsEl.innerHTML = `<div class="bullet">è¯·å…ˆåœ¨ index.html é¡¶éƒ¨æŠŠ <b>NEWS_API_URL</b> å¡«æˆä½ éƒ¨ç½²åçš„ Cloudflare Worker åœ°å€ã€‚</div>`;
        tipEl.textContent = "ï¼ˆä½ é€‰äº†çœŸ AI æ€»ç»“ï¼Œæ‰€ä»¥éœ€è¦ Worker æä¾›æ¥å£ã€‚ï¼‰";
        return;
      }

      try{
        const res = await fetch(NEWS_API_URL, {cache: "no-store"});
        if(!res.ok) throw new Error("HTTP " + res.status);
        const data = await res.json();

        const dt = data.date || "";
        stampEl.textContent = dt ? `æ›´æ–°ï¼š${dt}` : "å·²æ›´æ–°";

        const bullets = Array.isArray(data.bullets) ? data.bullets : [];
        if(bullets.length === 0){
          bulletsEl.innerHTML = `<div class="bullet">æš‚æ— è¦ç‚¹</div>`;
        }else{
          bulletsEl.innerHTML = bullets.map(t => `<div class="bullet">${esc(t)}</div>`).join("");
        }

        const sources = Array.isArray(data.sources) ? data.sources : [];
        sourcesEl.innerHTML = sources.map(s=>{
          const title = esc(s.title || "æ¥æº");
          const meta = esc((s.source ? s.source + " Â· " : "") + (s.published || ""));
          const url = esc(s.url || "#");
          return `<a class="src" href="${url}" target="_blank" rel="noopener">
                    <div class="t">${title}</div>
                    <div class="m">${meta}</div>
                  </a>`;
        }).join("");

        tipEl.textContent = "";
      }catch(err){
        stampEl.textContent = "åŠ è½½å¤±è´¥";
        bulletsEl.innerHTML = `<div class="bullet">èµ„è®¯åŠ è½½å¤±è´¥ï¼š${esc(err.message || err)}</div>`;
        tipEl.textContent = "è¯·æ£€æŸ¥ï¼š1ï¼‰Worker æ˜¯å¦å·²éƒ¨ç½²ï¼›2ï¼‰NEWS_API_URL æ˜¯å¦æ­£ç¡®ï¼›3ï¼‰ç½‘ç»œæ˜¯å¦å¯è®¿é—®ã€‚";
      }
    }
    refreshBtn.addEventListener('click', loadNews);
    loadNews();

    /********************
     * 7) Supabase Auth + TikTok Accounts
     ********************/
    const authStateEl = document.getElementById('authState');
    const btnOpenLogin = document.getElementById('btnOpenLogin');
    const btnLogout = document.getElementById('btnLogout');

    const portalPill = document.getElementById('portalPill');
    const portalRefreshBtn = document.getElementById('portalRefreshBtn');

    const authMask = document.getElementById('authMask');
    const authModal = document.getElementById('authModal');
    const authClose = document.getElementById('authClose');
    const authEmail = document.getElementById('authEmail');
    const authPassword = document.getElementById('authPassword');
    const authLoginBtn = document.getElementById('authLoginBtn');
    const authErr = document.getElementById('authErr');

    // åˆå§‹åŒ– Supabase client
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY, {
      auth: {
        persistSession: true,
        autoRefreshToken: true,
        detectSessionInUrl: true
      }
    });

    function showAuthError(msg){
      authErr.style.display = "block";
      authErr.textContent = msg || "ç™»å½•å¤±è´¥";
    }
    function clearAuthError(){
      authErr.style.display = "none";
      authErr.textContent = "";
    }

    function openAuthModal(force=true){
      // force=trueï¼šä½œä¸ºé—¨ç¦æ˜¾ç¤ºï¼ˆä¸å…è®¸ç‚¹é®ç½©å…³é—­ï¼‰
      authMask.style.display = "block";
      authModal.style.display = "block";
      authClose.style.display = force ? "none" : "grid";
      authMask.dataset.force = force ? "1" : "0";
      clearAuthError();
      setTimeout(()=> authEmail.focus(), 60);
      document.body.style.overflow = "hidden";
    }
    function closeAuthModal(){
      authMask.style.display = "none";
      authModal.style.display = "none";
      clearAuthError();
      document.body.style.overflow = "";
    }

    // ç‚¹å‡»é®ç½©ï¼šåªæœ‰éå¼ºåˆ¶æ¨¡å¼æ‰å…è®¸å…³é—­
    authMask.addEventListener('click', ()=>{
      if(authMask.dataset.force === "1") return;
      closeAuthModal();
    });
    authClose.addEventListener('click', closeAuthModal);

    btnOpenLogin.addEventListener('click', ()=>{
      openAuthModal(false);
    });

    authLoginBtn.addEventListener('click', doLogin);
    authPassword.addEventListener('keydown', (e)=>{
      if(e.key === "Enter") doLogin();
    });

    async function doLogin(){
      clearAuthError();
      const email = (authEmail.value || "").trim();
      const password = (authPassword.value || "").trim();

      if(!email || !password){
        showAuthError("è¯·å¡«å†™é‚®ç®±å’Œå¯†ç ã€‚");
        return;
      }

      authLoginBtn.disabled = true;
      authLoginBtn.textContent = "ç™»å½•ä¸­â€¦";

      try{
        const { data, error } = await supabaseClient.auth.signInWithPassword({ email, password });
        if(error) throw error;

        closeAuthModal();
        await refreshAuthUI();
        await loadTikTokAccounts(); // ç™»å½•åè‡ªåŠ¨åŠ è½½
      }catch(err){
        showAuthError(err && err.message ? err.message : String(err));
      }finally{
        authLoginBtn.disabled = false;
        authLoginBtn.textContent = "ç™»å½•";
      }
    }

    btnLogout.addEventListener('click', async ()=>{
      btnLogout.disabled = true;
      try{
        await supabaseClient.auth.signOut();
      }catch(e){
        // ä¸ç”¨ alert
      }finally{
        btnLogout.disabled = false;
        await refreshAuthUI();
        // é€€å‡ºåæ¸…ç©º portal æ˜¾ç¤º
        renderPortalEmpty();
        openAuthModal(true);
      }
    });

    // é—¨ç¦ç­–ç•¥ï¼šæœªç™»å½• -> å¼ºåˆ¶æ˜¾ç¤ºç™»å½•å¼¹çª—ï¼ˆæ›¿ä»£ promptï¼‰
    async function refreshAuthUI(){
      const { data } = await supabaseClient.auth.getSession();
      const session = data && data.session ? data.session : null;

      if(session && session.user){
        const email = session.user.email || "å·²ç™»å½•";
        authStateEl.textContent = `å·²ç™»å½•ï¼š${email}`;
        btnLogout.style.display = "inline-block";
        btnOpenLogin.style.display = "none";
        portalPill.textContent = "å·²ç™»å½• Â· å¯åŠ è½½è´¦å·åˆ—è¡¨";
      }else{
        authStateEl.textContent = "æœªç™»å½•";
        btnLogout.style.display = "none";
        btnOpenLogin.style.display = "inline-block";
        portalPill.textContent = "æœªç™»å½• Â· è´¦å·åˆ—è¡¨æœªåŠ è½½";
      }
      return session;
    }

    function renderPortalEmpty(){
      const regions = ["US","SG","VN","MY"];
      regions.forEach(r=>{
        const root = document.getElementById("portal-" + r);
        if(!root) return;
        root.innerHTML = `
          <div class="portalGroupTitle">è‡ªè¥è´¦å·</div>
          <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
          <div class="portalGroupTitle" style="margin-top:12px;">è¾¾äººè´¦å·</div>
          <div class="portalHint">ï¼ˆè¯·ç™»å½•ååŠ è½½ï¼‰</div>
        `;
      });
    }

    function acctRowHTML(tag, handle){
      const badge = esc(tag || "è´¦å·");
      const h = esc(handle || "");
      const url = handleToUrl(handle);
      const openAttr = url ? `data-open="${esc(url)}"` : "";
      return `
        <div class="acctRow">
          <span class="badge">${badge}</span>
          <span class="handle">${h || "-"}</span>
          <div class="go" ${openAttr} title="æ‰“å¼€"><span>â†—</span></div>
        </div>
      `;
    }

    function attachGoHandlers(scopeEl){
      scopeEl.querySelectorAll('.go[data-open]').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const url = btn.getAttribute('data-open');
          if(url) window.open(url, '_blank', 'noopener');
        });
      });
    }

    function groupAccounts(rows){
      // rows: [{region, account_type, tag, handle, sort_order, is_active}]
      const byRegion = { US: [], SG: [], VN: [], MY: [] };
      rows.forEach(r=>{
        const reg = normRegion(r.region);
        if(!byRegion[reg]) byRegion[reg] = [];
        byRegion[reg].push(r);
      });
      return byRegion;
    }

    function splitByType(list){
      const map = new Map();
      list.forEach(it=>{
        const key = prettyAccountType(it.account_type);
        if(!map.has(key)) map.set(key, []);
        map.get(key).push(it);
      });
      return map; // title -> items
    }

    async function loadTikTokAccounts(){
      // å¿…é¡»å·²ç™»å½•ï¼Œå¦åˆ™ç›´æ¥æç¤º
      const { data } = await supabaseClient.auth.getSession();
      const session = data && data.session ? data.session : null;
      if(!session){
        portalPill.textContent = "æœªç™»å½• Â· è¯·å…ˆç™»å½•";
        renderPortalEmpty();
        openAuthModal(true);
        return;
      }

      portalPill.textContent = "åŠ è½½ä¸­â€¦";
      portalRefreshBtn.disabled = true;

      try{
        // åªè¯»å­—æ®µï¼šid, region, account_type, tag, handle, sort_order, is_active, created_at
        const { data: rows, error } = await supabaseClient
          .from("tiktok_accounts")
          .select("id, region, account_type, tag, handle, sort_order, is_active, created_at")
          .eq("is_active", true)
          .order("region", { ascending: true })
          .order("account_type", { ascending: true })
          .order("sort_order", { ascending: true });

        if(error) throw error;

        const list = Array.isArray(rows) ? rows : [];
        const grouped = groupAccounts(list);

        ["US","SG","VN","MY"].forEach(r=>{
          const root = document.getElementById("portal-" + r);
          if(!root) return;

          const items = grouped[r] || [];
          if(items.length === 0){
            root.innerHTML = `
              <div class="portalGroupTitle">è‡ªè¥è´¦å·</div>
              <div class="portalHint">ï¼ˆæš‚æ— ï¼‰</div>
              <div class="portalGroupTitle" style="margin-top:12px;">è¾¾äººè´¦å·</div>
              <div class="portalHint">ï¼ˆæš‚æ— ï¼‰</div>
            `;
            return;
          }

          const byType = splitByType(items);

          // æˆ‘ä»¬å°½é‡ç»´æŒä½ åŸæœ¬çš„â€œè‡ªè¥è´¦å· / è¾¾äººè´¦å·â€ä¸¤ä¸ªç»„ã€‚
          // å¦‚æœè¡¨é‡Œè¿˜æœ‰å…¶ä»– account_typeï¼Œä¼šè¿½åŠ åœ¨ä¸‹é¢ï¼ˆä¸æ”¹å˜åˆ—/å¡çš„æ•´ä½“å¸ƒå±€ï¼‰ã€‚
          const preferredOrder = ["è‡ªè¥è´¦å·","è¾¾äººè´¦å·"];

          let html = "";
          preferredOrder.forEach(ttl=>{
            const arr = byType.get(ttl) || [];
            html += `<div class="portalGroupTitle">${esc(ttl)}</div>`;
            if(arr.length === 0){
              html += `<div class="portalHint">ï¼ˆæš‚æ— ï¼‰</div>`;
            }else{
              html += `<div class="acctList">` + arr.map(a => acctRowHTML(a.tag, a.handle)).join("") + `</div>`;
            }
            html += `<div style="height:12px;"></div>`;
          });

          // è¿½åŠ å…¶ä»–ç±»å‹ï¼ˆå¦‚æœå­˜åœ¨ï¼‰
          for(const [ttl, arr] of byType.entries()){
            if(preferredOrder.includes(ttl)) continue;
            html += `<div class="portalGroupTitle">${esc(ttl)}</div>`;
            html += `<div class="acctList">` + arr.map(a => acctRowHTML(a.tag, a.handle)).join("") + `</div>`;
            html += `<div style="height:12px;"></div>`;
          }

          root.innerHTML = html.replace(/<div style="height:12px;"><\/div>\s*$/,"");
          attachGoHandlers(root);
        });

        portalPill.textContent = `å·²åŠ è½½ Â· å…± ${list.length} ä¸ªè´¦å·`;
      }catch(err){
        portalPill.textContent = "åŠ è½½å¤±è´¥";
        // ç”¨ portal å†…æç¤ºï¼Œä¸ç”¨ alert
        ["US","SG","VN","MY"].forEach(r=>{
          const root = document.getElementById("portal-" + r);
          if(!root) return;
          root.innerHTML = `
            <div class="portalGroupTitle">æç¤º</div>
            <div class="portalHint">è´¦å·åŠ è½½å¤±è´¥ï¼š${esc(err && err.message ? err.message : String(err))}</div>
            <div class="portalHint">è¯·æ£€æŸ¥ï¼š1ï¼‰RLS/Policy æ˜¯å¦æ­£ç¡®ï¼›2ï¼‰ä½ æ˜¯å¦å·²ç™»å½•ï¼›3ï¼‰è¡¨é‡Œ region/account_type å€¼æ˜¯å¦è§„èŒƒã€‚</div>
          `;
        });
      }finally{
        portalRefreshBtn.disabled = false;
      }
    }

    portalRefreshBtn.addEventListener('click', loadTikTokAccounts);

    // ç›‘å¬ç™»å½•çŠ¶æ€å˜åŒ–
    supabaseClient.auth.onAuthStateChange(async (_event, _session)=>{
      const sess = await refreshAuthUI();
      if(sess){
        // å·²ç™»å½•å°±å°è¯•åŠ è½½
        await loadTikTokAccounts();
      }
    });

    // åˆå§‹ï¼šæ£€æŸ¥ sessionï¼›æœªç™»å½•åˆ™å¼ºåˆ¶æ˜¾ç¤ºç™»å½•å¼¹çª—ï¼ˆæ›¿ä»£ prompt é—¨ç¦ï¼‰
    (async function bootAuth(){
      const sess = await refreshAuthUI();
      if(!sess){
        renderPortalEmpty();
        openAuthModal(true);
      }else{
        // å·²ç™»å½•ç›´æ¥åŠ è½½
        await loadTikTokAccounts();
      }
    })();

  </script>
</body>
</html>
